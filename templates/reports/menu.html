{% extends "base.html" %}
  {% block container %}
<nav class="navbar navbar-default" role="navigation" ng-controller="NavbarController as vm">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">ФК Красота и Сила</a>
    </div> <!-- ./navbar-header -->
    <div class="collapse navbar-collapse">
      <ul ng-show="vm.user" class="nav navbar-nav pull-right">
      {% verbatim %}
        <li>{{ vm.user.username }}</li>
      {% endverbatim %}
          <li><a href="javascript:void(0)" ng-click="vm.logout()">Выход</a></li>
      </ul>
      <ul ng-show="!vm.user" class="nav navbar-nav pull-right">
          <li><a href="#/login">Вход</a></li>
      </ul>
    </div> <!-- /.collapse.navbar-collapse -->
  </div> <!-- /.container-fluid -->
</nav>

<div class="container-fluid">
  <label class="col-md-1 control-label">С:</label>
  <div class="col-md-2">
    <input name="fdate" type="text"  class="form-control date"
    value="{% now 'd.m.Y' %}">
  </div>
  <label class="col-md-1 control-label">По:</label>
  <div class="col-md-2">
    <input name="tdate" type="text"  class="form-control date"
    value="{% now 'd.m.Y' %}">
  </div>
</div>
<br>
<div class="row">
  <div class="col-md-3">
    <a id='r_active_card' href="/api/v1/reports/acc/?cc=0"
    class="btn btn-success btn-block">Активные клубные карты</a>
  </div>
  <div class="col-md-3">
    <select name="club_card_type" class="btn-block">
      <option value="0">все</option>
      {% for option in cc_options %}
      <option value="{{ option.club_card__pk }}">
        {{ option.club_card__name }}
      </option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <a id='r_freeze' href="/api/v1/reports/freeze/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}" class="btn btn-info btn-block">
       заморозки за период</a>
  </div>
  <div class="col-md-3">
    <a id='r_tcc'
    href="/api/v1/reports/tcc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-danger btn-block">
      персональные тренировки</a>
  </div>
</div>
<br>

<div class="row">
  <div class="col-md-3">
    <a id='r_ps' href="/api/v1/reports/ps/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}" class="btn btn-success btn-block">
       продажи за период</a>
  </div>
  <div class="col-md-3">
    <a id='r_active_card' href="/api/v1/reports/ccc/"
    class="btn btn-warning btn-block">Кредиты по клубным картам</a>
  </div>
  <div class="col-md-3">
    <a id='r_ep' href="/api/v1/reports/ep/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}" class="btn btn-info btn-block">
       продления за период</a>
  </div>
  <div class="col-md-3">
    <a id='r_icc'
    href="/api/v1/reports/icc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-danger btn-block">
      вводный инструктаж</a>
  </div>
</div>
<br>

<div class="row">
  <div class="col-md-3">
    <a id='r_cl'
    href="/api/v1/reports/cl/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-success btn-block">
      Список купленных карт</a>
  </div>
  <div class="col-md-3">
    <a id='r_op' href="/api/v1/reports/op/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}" class="btn btn-warning btn-block">
       отчет по оплате иное</a>
  </div>
  <div class="col-md-3">
    <a id='r_totalacc'
    href="/api/v1/reports/totalacc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-info btn-block" style="white-space: normal;">
      <small>Сводный по видам действующих карт на дату</small></a>
  </div>
  <div class="col-md-3">
    <a id='r_fcc'
    href="/api/v1/reports/fcc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-danger btn-block">тестирование (со скидкой 50%)</a>
  </div>
</div>
<br>

<div class="row">
  <div class="col-md-3">
    <a id='r_ccdiscounts'
    href="/api/v1/reports/ccdiscounts/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-success btn-block">
      Сводный по скидкам за период</a>
  </div>
  <div class="col-md-3">
    <a id='r_visits_p' href="/api/v1/reports/visits_p/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}" class="btn btn-warning btn-block">
       посещения за период</a>
  </div>
  <div class="col-md-3">
    <a id='r_totalcc'
    href="/api/v1/reports/totalcc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-info btn-block"  style="white-space: normal;font-size: 78%;">
      Сводный по видам проданных карт за период
    </a>
  </div>
  <div class="col-md-3">
    <a id='r_ccdisabled'
    href="/api/v1/reports/ccdisabled/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-danger btn-block">
       заблокированные карты за период</a>
  </div>
</div>
<br>

<div class="row">
  <div class="col-lg-3">
    <a id='r_bl' href="/api/v1/reports/bl/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}" class="btn btn-success btn-block">
       по выгодной лояльности</a>
  </div>
  <div class="col-lg-3">
    <a id='r_new_uid'
    href="/api/v1/reports/new_uid/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
    class="btn btn-warning btn-block">
      Новые ЧС</a>
  </div>
  <div class="col-md-3">
    <a id='r_fl' href="/api/v1/reports/fl/" class="btn btn-info btn-block">
      Полный список клиентов</a>
  </div>
  <div class="col-md-3">
    <a id='r_ccdisabled' href="/api/v1/reports/ccprospect/" class="btn btn-danger btn-block">неактивированные карты</a>
  </div>
</div>
<br>
<!-- clip(personal) cards -->
<div class="row">
  <div class="col-md-3">
    <a id='r_active_personal' href="/api/v1/reports/apc/?pc=0"
    class="btn btn-success btn-block">Активные клип карты</a>
  </div>
  <div class="col-md-3">
    <select name="personal_type" class="btn-block">
      <option value="0">все</option>
      {% for option in pc_options %}
      <option value="{{ option.personal__pk }}">
        {{ option.personal__name }}
      </option>
      {% endfor %}
    </select>
  </div>
</div>
<br>

<!-- clip(personal) cards by coach -->
<div class="clo-md-12">&nbsp;</div>
<div class="row">
  <div class="col-md-3">
    Тренер
  </div>
  <div class="col-md-3">
    <select name="personal_coach" class="btn-block">
      <option value="0">все</option>
      {% for option in trainers %}
      <option value="{{ option.pk }}">
        {{ option.initials }}
      </option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <a id='r_use_personal' href="/api/v1/reports/upc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}&c=0"
    class="btn btn-info btn-block" style="white-space: normal;">
      <small>Отчёт по проведенным персональным тренировкам</small></a>
  </div>
    <div class="col-md-3">
    <a
      id='r_total_personal'
      href="/api/v1/reports/tpc/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
      class="btn btn-danger btn-block" style="white-space: normal;"><small>Сводный отчет по видам проданных клип-карт</small></a>
  </div>
</div>
<br>

<!-- reception -->
  <div class="col-md-5 center-block">&nbsp;</div>
  <div class="col-md-3 center-block"><strong>Ресепшен</strong></div>
  <div class="col-md-4 center-block">&nbsp;</div>
  <div class="clo-md-12">&nbsp;</div>
  <div class="row">
    <div class="col-lg-3">
      <a id='r_sells' href="/api/v1/reports/sales/?fdate={% now 'd.m.Y' %}" class="btn btn-success btn-block">
        продажи за день</a>
    </div>
    <div class="col-lg-3">
      <a id='r_visits'
      href="/api/v1/reports/visits/?fdate={% now 'd.m.Y' %}"
      class="btn btn-warning btn-block">
        посещения</a>
    </div>
    <div class="col-lg-3">
      <a id='r_birthdays'
      href="/api/v1/reports/birthdays/?fdate={% now 'd.m.Y' %}&tdate={% now 'd.m.Y' %}"
      class="btn btn-info btn-block">
        Дни рождения</a>
    </div>
  </div>

{% endblock %}

{% block extra_js %}
<script type="text/javascript">

var updateUrlParam = function updateUrlParam(get_string, param, value) {
  var sURLVariables = get_string.substring(1).split('&')
  for (i = 0; i < sURLVariables.length; i++) {
    var sParameterName = sURLVariables[i].split('=');
    if (sParameterName[0] === param) {
      sURLVariables[i] = sParameterName[0] + '=' + value
      return '?' + sURLVariables.join('&')
    }
  }
}

  jQuery(function($){
   $(".date").mask("99.99.9999");

  $('[name=fdate]').change(function() {
    var fdate = $(this).val()
    // r_sells
    var r_sells = $('#r_sells').attr('href').split('/')
    var get_str = updateUrlParam(r_sells[5], 'fdate', fdate)
    var r_sells_url = r_sells.slice(0, 5).join('/') + '/' + get_str
    $('#r_sells').attr('href', r_sells_url)
    // r_visits
    var r_visits = $('#r_visits').attr('href').split('/')
    var get_str = updateUrlParam(r_visits[5], 'fdate', fdate)
    var r_visits_url = r_visits.slice(0, 5).join('/') + '/' + get_str
    $('#r_visits').attr('href', r_visits_url)
    // r_birthdays
    var r_birthdays = $('#r_birthdays').attr('href').split('/')
    var get_str = updateUrlParam(r_birthdays[5], 'fdate', fdate)
    var r_birthdays_url = r_birthdays.slice(0, 5).join('/') + '/' + get_str
    $('#r_birthdays').attr('href', r_birthdays_url)
    // r_new_uid
    var r_new_uid = $('#r_new_uid').attr('href').split('/')
    var get_str = updateUrlParam(r_new_uid[5], 'fdate', fdate)
    var r_new_uid_url = r_new_uid.slice(0, 5).join('/') + '/' + get_str
    $('#r_new_uid').attr('href', r_new_uid_url)
    // r_cl
    var r_cl = $('#r_cl').attr('href').split('/')
    var get_str = updateUrlParam(r_cl[5], 'fdate', fdate)
    var r_cl_url = r_cl.slice(0, 5).join('/') + '/' + get_str
    $('#r_cl').attr('href', r_cl_url)
    // r_fcc
    var r_fcc = $('#r_fcc').attr('href').split('/')
    var get_str = updateUrlParam(r_fcc[5], 'fdate', fdate)
    var r_fcc_url = r_fcc.slice(0, 5).join('/') + '/' + get_str
    $('#r_fcc').attr('href', r_fcc_url)
    // r_tcc
    var r_tcc = $('#r_tcc').attr('href').split('/')
    var get_str = updateUrlParam(r_tcc[5], 'fdate', fdate)
    var r_tcc_url = r_tcc.slice(0, 5).join('/') + '/' + get_str
    $('#r_tcc').attr('href', r_tcc_url)
    // r_icc
    var r_icc = $('#r_icc').attr('href').split('/')
    var get_str = updateUrlParam(r_icc[5], 'fdate', fdate)
    var r_icc_url = r_icc.slice(0, 5).join('/') + '/' + get_str
    $('#r_icc').attr('href', r_icc_url)
    // r_totalcc
    var r_totalcc = $('#r_totalcc').attr('href').split('/')
    var get_str = updateUrlParam(r_totalcc[5], 'fdate', fdate)
    var r_totalcc_url = r_totalcc.slice(0, 5).join('/') + '/' + get_str
    $('#r_totalcc').attr('href', r_totalcc_url)
    // r_totalacc
    var r_totalacc = $('#r_totalacc').attr('href').split('/')
    var get_str = updateUrlParam(r_totalacc[5], 'fdate', fdate)
    var r_totalacc_url = r_totalacc.slice(0, 5).join('/') + '/' + get_str
    $('#r_totalacc').attr('href', r_totalacc_url)
    // r_ccdiscounts
    var r_ccdiscounts = $('#r_ccdiscounts').attr('href').split('/')
    var get_str = updateUrlParam(r_ccdiscounts[5], 'fdate', fdate)
    var r_ccdiscounts_url = r_ccdiscounts.slice(0, 5).join('/') + '/' + get_str
    $('#r_ccdiscounts').attr('href', r_ccdiscounts_url)
    // r_ccdisabled
    var r_ccdisabled = $('#r_ccdisabled').attr('href').split('/')
    var get_str = updateUrlParam(r_ccdisabled[5], 'fdate', fdate)
    var r_ccdisabled_url = r_ccdisabled.slice(0, 5).join('/') + '/' + get_str
    $('#r_ccdisabled').attr('href', r_ccdisabled_url)
    // r_bl
    var r_bl = $('#r_bl').attr('href').split('/')
    var get_str = updateUrlParam(r_bl[5], 'fdate', fdate)
    var r_bl_url = r_bl.slice(0, 5).join('/') + '/' + get_str
    $('#r_bl').attr('href', r_bl_url)
    // r_ps
    var r_ps = $('#r_ps').attr('href').split('/')
    var get_str = updateUrlParam(r_ps[5], 'fdate', fdate)
    var r_ps_url = r_ps.slice(0, 5).join('/') + '/' + get_str
    $('#r_ps').attr('href', r_ps_url)
    // r_ep
    var r_ep = $('#r_ep').attr('href').split('/')
    var get_str = updateUrlParam(r_ep[5], 'fdate', fdate)
    var r_ep_url = r_ep.slice(0, 5).join('/') + '/' + get_str
    $('#r_ep').attr('href', r_ep_url)
    // r_visits_p
    var r_visits_p = $('#r_visits_p').attr('href').split('/')
    var get_str = updateUrlParam(r_visits_p[5], 'fdate', fdate)
    var r_visits_p_url = r_visits_p.slice(0, 5).join('/') + '/' + get_str
    $('#r_visits_p').attr('href', r_visits_p_url)
    // r_op
    var r_op = $('#r_op').attr('href').split('/')
    var get_str = updateUrlParam(r_op[5], 'fdate', fdate)
    var r_op_url = r_op.slice(0, 5).join('/') + '/' + get_str
    $('#r_op').attr('href', r_op_url)
    // r_freeze
    var r_freeze = $('#r_freeze').attr('href').split('/')
    var get_str = updateUrlParam(r_freeze[5], 'fdate', fdate)
    var r_freeze_url = r_freeze.slice(0, 5).join('/') + '/' + get_str
    $('#r_freeze').attr('href', r_freeze_url)
    // r_use_personal
    var r_use_personal = $('#r_use_personal').attr('href').split('/')
    var get_str = updateUrlParam(r_use_personal[5], 'fdate', fdate)
    var r_use_personal_url = r_use_personal.slice(0, 5).join('/') + '/' + get_str
    $('#r_use_personal').attr('href', r_use_personal_url)
    // r_total_personal
    var r_total_personal = $('#r_total_personal').attr('href').split('/')
    var get_str = updateUrlParam(r_total_personal[5], 'fdate', fdate)
    var r_total_personal_url = r_total_personal.slice(0, 5).join('/') + '/' + get_str
    $('#r_total_personal').attr('href', r_total_personal_url)
  });

  $('[name=tdate]').change(function() {
    var tdate = $(this).val()
    // r_birthdays
    var r_birthdays = $('#r_birthdays').attr('href').split('/')
    var get_str = updateUrlParam(r_birthdays[5], 'tdate', tdate)
    var r_birthdays_url = r_birthdays.slice(0, 5).join('/') + '/' + get_str
    $('#r_birthdays').attr('href', r_birthdays_url)
    // r_new_uid
    var r_new_uid = $('#r_new_uid').attr('href').split('/')
    var get_str = updateUrlParam(r_new_uid[5], 'tdate', tdate)
    var r_new_uid_url = r_new_uid.slice(0, 5).join('/') + '/' + get_str
    $('#r_new_uid').attr('href', r_new_uid_url)
    // r_cl
    var r_cl = $('#r_cl').attr('href').split('/')
    var get_str = updateUrlParam(r_cl[5], 'tdate', tdate)
    var r_cl_url = r_cl.slice(0, 5).join('/') + '/' + get_str
    $('#r_cl').attr('href', r_cl_url)
    // r_fcc
    var r_fcc = $('#r_fcc').attr('href').split('/')
    var get_str = updateUrlParam(r_fcc[5], 'tdate', tdate)
    var r_fcc_url = r_fcc.slice(0, 5).join('/') + '/' + get_str
    $('#r_fcc').attr('href', r_fcc_url)
    // r_tcc
    var r_tcc = $('#r_tcc').attr('href').split('/')
    var get_str = updateUrlParam(r_tcc[5], 'tdate', tdate)
    var r_tcc_url = r_tcc.slice(0, 5).join('/') + '/' + get_str
    $('#r_tcc').attr('href', r_tcc_url)
    // r_icc
    var r_icc = $('#r_icc').attr('href').split('/')
    var get_str = updateUrlParam(r_icc[5], 'tdate', tdate)
    var r_icc_url = r_icc.slice(0, 5).join('/') + '/' + get_str
    $('#r_icc').attr('href', r_icc_url)
    // r_totalcc
    var r_totalcc = $('#r_totalcc').attr('href').split('/')
    var get_str = updateUrlParam(r_totalcc[5], 'tdate', tdate)
    var r_totalcc_url = r_totalcc.slice(0, 5).join('/') + '/' + get_str
    $('#r_totalcc').attr('href', r_totalcc_url)
    // r_totalacc
    var r_totalacc = $('#r_totalacc').attr('href').split('/')
    var get_str = updateUrlParam(r_totalacc[5], 'tdate', tdate)
    var r_totalacc_url = r_totalacc.slice(0, 5).join('/') + '/' + get_str
    $('#r_totalacc').attr('href', r_totalacc_url)
    // r_ccdiscounts
    var r_ccdiscounts = $('#r_ccdiscounts').attr('href').split('/')
    var get_str = updateUrlParam(r_ccdiscounts[5], 'tdate', tdate)
    var r_ccdiscounts_url = r_ccdiscounts.slice(0, 5).join('/') + '/' + get_str
    $('#r_ccdiscounts').attr('href', r_ccdiscounts_url)
    // r_ccdisabled
    var r_ccdisabled = $('#r_ccdisabled').attr('href').split('/')
    var get_str = updateUrlParam(r_ccdisabled[5], 'tdate', tdate)
    var r_ccdisabled_url = r_ccdisabled.slice(0, 5).join('/') + '/' + get_str
    $('#r_ccdisabled').attr('href', r_ccdisabled_url)
    // r_bl
    var r_bl = $('#r_bl').attr('href').split('/')
    var get_str = updateUrlParam(r_bl[5], 'tdate', tdate)
    var r_bl_url = r_bl.slice(0, 5).join('/') + '/' + get_str
    $('#r_bl').attr('href', r_bl_url)
    // r_ps
    var r_ps = $('#r_ps').attr('href').split('/')
    var get_str = updateUrlParam(r_ps[5], 'tdate', tdate)
    var r_ps_url = r_ps.slice(0, 5).join('/') + '/' + get_str
    $('#r_ps').attr('href', r_ps_url)
    // r_ep
    var r_ep = $('#r_ep').attr('href').split('/')
    var get_str = updateUrlParam(r_ep[5], 'tdate', tdate)
    var r_ep_url = r_ep.slice(0, 5).join('/') + '/' + get_str
    $('#r_ep').attr('href', r_ep_url)
    // r_visits_p
    var r_visits_p = $('#r_visits_p').attr('href').split('/')
    var get_str = updateUrlParam(r_visits_p[5], 'tdate', tdate)
    var r_visits_p_url = r_visits_p.slice(0, 5).join('/') + '/' + get_str
    $('#r_visits_p').attr('href', r_visits_p_url)
    // r_op
    var r_op = $('#r_op').attr('href').split('/')
    var get_str = updateUrlParam(r_op[5], 'tdate', tdate)
    var r_op_url = r_op.slice(0, 5).join('/') + '/' + get_str
    $('#r_op').attr('href', r_op_url)
    // r_freeze
    var r_freeze = $('#r_freeze').attr('href').split('/')
    var get_str = updateUrlParam(r_freeze[5], 'tdate', tdate)
    var r_freeze_url = r_freeze.slice(0, 5).join('/') + '/' + get_str
    $('#r_freeze').attr('href', r_freeze_url)
    // r_use_personal
    var r_use_personal = $('#r_use_personal').attr('href').split('/')
    var get_str = updateUrlParam(r_use_personal[5], 'tdate', tdate)
    var r_use_personal_url = r_use_personal.slice(0, 5).join('/') + '/' + get_str
    $('#r_use_personal').attr('href', r_use_personal_url)
    // r_total_personal
    var r_total_personal = $('#r_total_personal').attr('href').split('/')
    var get_str = updateUrlParam(r_total_personal[5], 'tdate', tdate)
    var r_total_personal_url = r_total_personal.slice(0, 5).join('/') + '/' + get_str
    $('#r_total_personal').attr('href', r_total_personal_url)
  });

  $('[name=club_card_type]').change(function() {
    var club_card_type = $(this).val()
    var r_active_card = $('#r_active_card').attr('href').split('/')
    var get_str = updateUrlParam(r_active_card[5], 'cc', club_card_type)
    var r_active_card_url = r_active_card.slice(0, 5).join('/') + '/' + get_str
    $('#r_active_card').attr('href', r_active_card_url)
  });

  $('[name=personal_type]').change(function() {
    var club_card_type = $(this).val()
    var r_active_personal = $('#r_active_personal').attr('href').split('/')
    var get_str = updateUrlParam(r_active_personal[5], 'pc', club_card_type)
    var r_active_personal_url = r_active_personal.slice(0, 5).join('/') + '/' + get_str
    $('#r_active_personal').attr('href', r_active_personal_url)
  });

  $('[name=personal_coach]').change(function() {
    var coach = $(this).val()
    var r_use_personal = $('#r_use_personal').attr('href').split('/')
    var get_str = updateUrlParam(r_use_personal[5], 'c', coach)
    var r_use_personal_url = r_use_personal.slice(0, 5).join('/') + '/' + get_str
    $('#r_use_personal').attr('href', r_use_personal_url)
  });
});
</script>

  {% endblock %}
